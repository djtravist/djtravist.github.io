<!DOCTYPE html>
<html lang="en">
<head>
  <!-- âœ… Firebase SDKs for compat mode (v8-style) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <meta charset="UTF-8" />
  <title>Varsity Game Videos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      color: #333;
      padding: 2em;
    }
    h1 {
      text-align: center;
      margin-bottom: 1em;
    }
    h2 {
      margin-top: 2em;
    }
    video {
      display: block;
      margin: 0 auto 2em auto;
      max-width: 100%;
      height: auto;
      border: 1px solid #ccc;
      background: #000;
    }
  </style>
</head>

<body>
  <h1>Varsity Game Videos</h1>

  <div id="videoContainer"></div>

<script>
  // Your Firebase config
  const firebaseConfig = {
  apiKey: "AIzaSyBPJGqsH_pLXffDt6ol3SOxgC9joKUdKm4",
  authDomain: "footballvideocounter.firebaseapp.com",
  projectId: "footballvideocounter",
  storageBucket: "footballvideocounter.firebasestorage.app",
  messagingSenderId: "126776947656",
  appId: "1:126776947656:web:cf05806375edaa3c27c6fd"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  const folderName = 'centennial';
  const videoPrefix = 'Centennial';
  const totalVideos = 69;

  const container = document.getElementById('videoContainer');

  for (let i = 1; i <= totalVideos; i++) {
    const padded = String(i).padStart(2, '0');
    const videoId = `${videoPrefix}_${padded}`;

    const h2 = document.createElement('h2');
    h2.textContent = `${videoPrefix} ${i}`;

    const counter = document.createElement('div');
    counter.textContent = `Loading plays...`;
    counter.style.fontSize = '0.9em';
    counter.style.color = '#666';

    const video = document.createElement('video');
    video.controls = true;
    video.width = 640;

    const source = document.createElement('source');
    source.src = `${folderName}_${videoId}.mp4`;
    source.type = 'video/mp4';

    video.appendChild(source);
    video.appendChild(document.createTextNode('Your browser does not support the video tag.'));

    // ðŸ”¼ Get current play count
    db.collection("videoPlays").doc(videoId).get().then((doc) => {
      if (doc.exists) {
        counter.textContent = `Plays: ${doc.data().count}`;
      } else {
        counter.textContent = `Plays: 0`;
      }
    });

    // ðŸ”¼ On play, increment count
    video.addEventListener('play', () => {
      const ref = db.collection("videoPlays").doc(videoId);
      db.runTransaction((transaction) => {
        return transaction.get(ref).then((doc) => {
          const newCount = (doc.exists ? doc.data().count : 0) + 1;
          transaction.set(ref, { count: newCount });
          counter.textContent = `Views: ${newCount}`;
        });
      });
    });

    container.appendChild(h2);
    container.appendChild(counter);
    container.appendChild(video);
  }
</script>
</body>
</html>
